@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer

@model List<onlineExamApp.Models.Exam>

@{
    ViewData["Title"] = Localizer["MyExamsTitle"];
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<head>
    <link rel="stylesheet" href="~/css/page.css" asp-append-version="true" />
</head>

<div class="container">
    <h2>@Localizer["MyExamsTitle"]</h2>

    @if (!Model.Any())
    {
        <div class="alert alert-info">@Localizer["NoExamsCreated"]</div>
    }
    else
    {
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>@Localizer["Title"]</th>
                    <th>@Localizer["Subject"]</th>
                    <th>@Localizer["Start"]</th>
                    <th>@Localizer["End"]</th>
                    <th>@Localizer["Actions"]</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var exam in Model)
                {
                    <tr>
                        <td>@exam.Title</td>
                        <td>@exam.Subject</td>
                        <td>@exam.StartTimeUtc.ToString("g")</td>
                        <td>@exam.EndTimeUtc.ToString("g")</td>
                        <td>
                            <a href="/Exams/Details/@exam.Id" class="btn btn-sm btn-outline-main mb-1">@Localizer["Details"]</a>
                            <a href="/Exams/ManageQuestions?Id=@exam.Id" class="btn btn-sm btn-outline-main mb-1">@Localizer["Manage"]</a>

                            <form id="deleteForm-@exam.Id" asp-action="Delete" method="post" class="d-inline">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@exam.Id" />
                                <button type="button" class="btn btn-sm btn-danger" onclick="confirmDelete(@exam.Id)">
                                    @Localizer["Delete"]
                                </button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }

    <a href="/Exams/EducatorPage" class="btn btn-outline-main mt-3">@Localizer["BackToEducatorPage"]</a>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        function confirmDelete(examId) {
            Swal.fire({
                title: '@Localizer["DeleteConfirmTitle"]',
                text: '@Localizer["DeleteConfirmText"]',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: '@Localizer["DeleteConfirmButton"]'
            }).then((result) => {
                if (result.isConfirmed) {
                    document.getElementById(`deleteForm-${examId}`).submit();
                }
            });
        }
    </script>

    @if (TempData["DeleteError"] != null)
    {
        <script>
            Swal.fire({
                icon: 'error',
                title: '@Localizer["DeleteFailed"]',
                text: '@TempData["DeleteError"]'
            });
        </script>
    }
}



